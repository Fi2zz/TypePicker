!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.DatePicker=t()}(this,function(){"use strict";var e,t=(e={},{$on:function(t,a){e[t]||(e[t]=[]),e[t].push(a)},$emit:function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];var n=[].shift.call(t),i=e[n];if(!i||0===i.length)return!1;for(var r=0,s=void 0;s=i[r++];)s.apply(this,t)},$remove:function(t,a){var n=e[t];if(!n)return!1;if(a)for(var i=n.length-1;i>=0;i--)n[i]===a&&n.splice(i,1);else n&&(n.length=0)}});function a(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var a={};function n(e,t){return a=e,Object.prototype.toString.call(a)==="[object "+t+"]";var a}function i(e,t){for(var a in void 0===e&&(e={}),t)t.hasOwnProperty(a)&&(e[a]=t[a]);return e}for(var r=0;r<e.length;r++){var s=e[r];if(s)if(n(s,"Array"))for(var l=0;l<s.length;l++){var d=s[l];n(d,"Object")?a=i(a,d):n(d,"Date")||(a[d]=d)}else n(s,"Object")?a=i(a,s):(n(s,"String")||n(s,"Number"))&&(a[s]=s)}return a}var n=function(e,t){return"["+e+'="'+t+'"]'};function i(e,t,a){if(void 0===a&&(a=void 0),!e)return null;var n=e.getAttribute(t);return void 0===a&&(a=""),n||e.setAttribute(t,a)}function r(e,t,a){if(void 0===a&&(a="month"),e||(e=new Date),t||(t=new Date),"month"===a)return Math.abs(12*e.getFullYear()+e.getMonth()-(12*t.getFullYear()+t.getMonth()));if("days"===a){var n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),i=new Date(t.getFullYear(),t.getMonth(),t.getDate());return Math.round(n-i)/864e5}}var s=function(e,t){return new Date(e,t,1).getDay()},l=function(e,t){var a=new Date(e,t,1),n=Date.UTC(a.getFullYear(),a.getMonth()+1,0);return new Date(n).getUTCDate()},d=function(e){return""+(e>9?e:"0"+e)};function o(e){return Object.prototype.toString.call(e)}function u(e){return"[object Array]"===o(e)}function c(e){return"[object Object]"===o(e)}function h(e){return"[object Date]"===o(e)}function f(e,t){return!!(e&&t&&e.className&&-1!=e.className.search(new RegExp("\\b"+t+"\\b")))}function g(e,t){!e||!t||e.className&&-1!=e.className.search(new RegExp("\\b"+t+"\\b"))||(e.className+=(e.className?" ":"")+t)}function v(e,t){!e||!t||e.className&&-1==e.className.search(new RegExp("\\b"+t+"\\b"))||(e.className=e.className.replace(new RegExp("\\s*\\b"+t+"\\b","g"),""))}function D(e){window.setTimeout(e,0)}function m(e){window.clearTimeout(e)}function p(e,t){var a=t;(c(t)||u(t))&&(a=JSON.stringify(t)),console.error("["+e+"] "+a+" ")}var w=new Date;function b(e){var t=e.date,a=e.infiniteMode,n=e.endDate,i=["calendar-cell","calendar-date-cell"];return t?(a||(r(t,w,"days")<0&&i.push("disabled"),n&&r(t,n,"days")>0&&i.push("disabled")),0===t.getDay()&&i.push("calendar-cell-weekend"),6===t.getDay()&&i.push("calendar-cell-weekday")):i.push("disabled","empty"),i.join(" ")}function y(e){for(var t=e.year,a=e.month,n=e.infiniteMode,i=e.formatter,r=e.endDate,d=[],o=new Date(t,a,1),u={year:o.getFullYear(),month:o.getMonth(),date:o.getDate(),index:o.getMonth()},c=s(u.year,u.month),h=0;h<c;h++)d.push({date:"",className:b({}),text:M(),key:""});for(h=1;h<=l(u.year,u.month);h++){var f=new Date(u.year,u.month,h),g=i(f),v=g.value,D=M(g.date),m=b({date:f,infiniteMode:n,endDate:r});d.push({className:m,text:D,key:v})}return{template:d.map(function(e){return t=e.className,a=e.key,n=e.text,'<div class="'+t+'"'+(a?"data-date="+a:"")+">"+n+"</div>";var t,a,n}).join(" "),year:u.year,month:u.index}}function M(e){return'<div class="date">'+(e||"")+'</div><div class="placeholder"></div>'}function Y(e){var t,a,n,i,s,l,d,o,u=e.startDate,c=e.endDate,h=e.multiViews,f=e.flatView,g=e.singleView,v=e.language,D=e.infiniteMode,m=e.parse,p=e.formatter,w={template:function(e){for(var t=e.startDate,a=e.endDate,n=e.gap,i=e.infiniteMode,r=e.formatter,s=e.parse,l=[],d=0;d<=n;d++){var o=new Date(t.getFullYear(),t.getMonth()+d,1),u=y({year:o.getFullYear(),month:o.getMonth(),formatter:r,parse:s,infiniteMode:i,endDate:a});l.push({template:u.template,year:u.year,month:u.month})}return l}({startDate:u,endDate:c,gap:h?1:f?r(u,c):0,infiniteMode:D,formatter:p,parse:m}),multiViews:h,flatView:f,language:v,singleView:g};return(h||g?"<div class=\"calendar-action-bar\">\n            <button class='calendar-action calendar-action-prev'><span>prev</span></button>\n            <button class='calendar-action calendar-action-next'><span>next</span></button>\n         </div>\n    ":"")+(a=(t=w).template,n=t.multiViews,i=t.flatView,s=t.singleView,l=t.language,d=l.week.map(function(e,t){return'<div class="'+["calendar-cell","calendar-day-cell",0===t?"calendar-cell-weekday":6===t?"calendar-cell-weekend":""].join(" ")+'">'+e+"</div>"}).join(""),o=a.map(function(e){var t=e.year,a=e.month,i='<div class="calendar-title">'+l.title(t,a)+"</div>",r=e.template,o="";return n||s?o+="<div class='calendar-main'>\n                    <div class=\"calendar-head\">"+i+'</div>\n                   <div class="calendar-day"> '+d+'</div>\n                    <div class="calendar-body">'+r+"</div>\n              </div>":o='<div class="calendar-main">\n                   <div class="calendar-head">'+i+'</div>  \n                    <div class="calendar-body">'+r+"</div>\n            </div>",o}),i&&o.unshift('<div class="calendar-day">'+d+"</div>"),o.join(""))}var S=new Date,V=new Date(S.getFullYear(),S.getMonth(),S.getDate());function k(e,t,a,i){if(a)for(var r=t.querySelectorAll(".in-range"),s=0;s<r.length;s++)v(r[s],"in-range");else for(s=0;s<e.length;s++){var l=n("data-date",e[s]),d=t.querySelector(l);f(d,"active")||g(d,"in-range")}if(i)return[]}function F(e){var t=e.collector,a=e.collection,s=e.data,l=e.isDouble,d=e.parse,o=e.format,u=e.inDates,c=e.isInit,h=[];if(l){if(s.length>=2){var f=s[0],v=s[s.length-1];u(f)||(s=[]);for(var D=d(f),m=d(v),p=D.getFullYear(),w=D.getMonth(),b=D.getDate(),y=[],M=r(m,D,"days")+1,Y=0;Y<M;Y++){var S=o(new Date(p,w,b+Y)).value;u(S)||y.push(S)}y.length>=2&&(s=[])}(s.length>0&&c||!c)&&(h=function(e,t,a,n){for(var s=[],l=a[0],d=a[a.length-1],o=0;o<e.length;o++){var u=e[o],c=e[o+1];if(a.length>0){var h=i(e[o],"data-date");h===l?g(u,"start-date"):h===d&&g(u,"end-date")}else if(u&&c){var f=i(u,"data-date"),v=i(c,"data-date");f&&v&&r(n(f),V,"days")>=0&&(t(v)&&t(f)||t(f)&&!t(v))&&s.length<2&&(g(u,"start-date"),g(c,"end-date"),s.push(f,v))}}return a.length>0&&(s=a),s}(a,u,s,d));var F=function(e,t,a){for(var n=[],r=0;r<e.length;r++){var s=i(e[r],"data-date");s&&n.push(s)}var l=-1,d=-1;for(r=0;r<n.length;r++){var o=n[r];o===t?l=r:o===a&&(d=r)}return d===l||d<0?[]:n.slice(l+1,d)}(a,h[0],h[h.length-1]);F.length>0&&k(F,t,!1)}else h=s;for(Y=0;Y<h.length;Y++){var x=n("data-date",h[Y]);g(t.querySelector(x),"active")}return h}function x(e){return e?"[object String]"!==o(e)?e:e.indexOf("#")>=0?document.querySelector(e):e.indexOf(".")>=0?document.querySelectorAll(e)[0]:e.indexOf("#")<=-1||e.indexOf(".")<=-1?(p("ParseEl ","do not mount DatePicker to a pure html tag,"+e),!1):document.querySelector(e):null}var N={locale:"zh-cn",pack:{days:["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],months:["01\u6708","02\u6708","03\u6708","04\u6708","05\u6708","06\u6708","07\u6708","08\u6708","09\u6708","10\u6708","11\u6708","12\u6708"],year:"\u5e74"}};function j(e){var t={year:this.date.getFullYear(),month:this.date.getMonth(),date:this.date.getDate()};this.date=new Date(t.year,t.month+e,t.date),this.createDatePicker(!1),this.pickDate(),this.dataRenderer(this.data)}function q(e){(this.element.innerHTML=Y({startDate:this.date,endDate:this.endDate,multiViews:this.multiViews,flatView:this.flatView,singleView:this.singleView,language:this.language,infiniteMode:this.infiniteMode,formatter:this.format,parse:this.parse}),this.bindMonthSwitch(),this.selected=this.currentRange(this.isFromSetRange),this.singleView)&&(this.double&&this.selected.length>=2&&this.selected[0]===this.selected[this.selected.length-1]&&this.selected.pop());var t={type:e?"init":"switch",value:this.selected};this.update(t)}function O(e){var t=this.defaultDates.length>0?this.defaultDates:this.double?this.selected:[this.format(this.date).value];return F({collector:this.element,collection:this.element.querySelectorAll(".calendar-date-cell:not(.empty)"),data:t,isDouble:this.double,parse:this.parse,format:this.format,inDates:this.inDates,isInit:e})}function R(){var e=this,t=this.element.querySelector(".calendar-action-prev"),a=this.element.querySelector(".calendar-action-next");t&&a&&(this.infiniteMode?(a.addEventListener("click",function(){e.doMonthSwitch(1)}),t.addEventListener("click",function(){e.doMonthSwitch(-1)})):(r(this.date,this.endDate)>=1?a.addEventListener("click",function(){e.doMonthSwitch(1),v(t,"disabled"),v(t,"calendar-action-disabled")}):(g(a,"disabled"),g(a,"calendar-action-disabled")),r(this.date,this.startDate)>=1?t.addEventListener("click",function(){e.doMonthSwitch(-1),v(a,"disabled"),v(a,"calendar-action-disabled")}):(g(t,"disabled"),g(t,"calendar-action-disabled"))))}function A(e,t){var a=this;e.doubleSelect&&(this.double=e.doubleSelect),this.dateFormat=e.format;var n,i,s,l,d,u,c=parseInt(e.views);if("auto"!==e.views&&isNaN(c)||1===c||c>2||c<=0?this.singleView=!0:"auto"===e.views?(this.flatView=!0,this.singleView=!1):2===c&&(this.multiViews=!0,this.singleView=!1),this.startDate=h(e.from)?e.from:new Date,this.date=this.startDate,this.endDate=h(e.to)?e.to:new Date(this.date.getFullYear(),this.date.getMonth()+6,0),this.limit=this.double?"[object Number]"===o(e.limit)?e.limit:1:1,!t.dates||t.dates&&t.dates.length<=0){for(var f=new Date,g=r(this.endDate,f,"days"),v=f.getFullYear(),w=f.getMonth(),b=f.getDate(),y=[],M=0;M<g;M++){var Y=new Date(v,w,b+M),S=this.format(Y).value;y.push(S)}this.data={},this.dates=y}else this.dates=t.dates,this.data=t.data,this.infiniteMode=!1;if(h(e.from)&&h(e.to)||(this.infiniteMode=!0,this.bindData&&p("init","infiniteMode is on, please provide [from] and [to] while binding data to datepicker  ")),this.language=(d=e.language,u=e.defaultLanguage,n=u&&d[u]?{locale:u,pack:d[u]}:N,i=n.locale.toLowerCase(),s=n.pack,l=s.months,{week:s.days,title:"en"===i||"en-us"===i||"en-gb"===i?function(e,t){return l[t]+" "+e}:function(e,t){return""+e+s.year+l[t]}}),this.element=x(e.el),!this.element)return p("init","invalid selector,current selector "+this.element),!1;this.element.className=this.element.className+" calendar calendar-"+(this.multiViews?"double-views":this.singleView?"single-view":"flat-view");var V=D(function(){if(a.defaultDates.length>0){var e=a.defaultDates[0];a.flatView||(a.date=a.parse(e))}a.createDatePicker(!0),a.pickDate(),m(V)})}var E=function(e){for(var t=e.element,a=e.selected,s=e.isDouble,l=e.parse,d=e.format,o=e.limit,u=e.inDates,c=e.update,h=e.infiniteMode,D=e.bindData,m=t.querySelectorAll(".calendar-date-cell"),p=function(e){var p=m[e];p.addEventListener("click",function(){var e=a,m=i(p,"data-date"),w=a.indexOf(m);if(!m||a.length<=0&&!u(m)&&D)return!1;if(w>=0&&(a=[a[a.length-1]]),(s&&a.length>=2||!s)&&(a=[]),a.push(m),s){var b=function(e){var t=e.selected,a=e.date,n=e.cache,i=e.limit,r=e.format,s=e.parse,l=e.inDates,d=e.bindData,o=[],u=[],c=!1,h=t[0],f=t[t.length-1],g=s(h),v=s(f);if(d){var D=I(g,v),m=t.length;if(m>=2)if(D<=0)l(a)?t.shift():t=[t[0]];else if(l(f))for(var p=g.getFullYear(),w=g.getMonth(),b=g.getDate(),y=1;y<D;y++){var M=new Date(p,w,b+y),Y=r(M).value;l(Y)&&u.push(Y),o.push(Y)}else l()&&f&&(t.shift(),o.push(f));else if(1===m){var S=t[t.length-1];if(l(S))t=[S];else if(n.length>=2){for(var V=[],y=0;y<n.length;y++)l(n[y])&&V.push(n[y]);if(V.length===n.length){var k=n[0],F=n[n.length-1];t=k!==F?n:[k]}else t=[]}else t=[n[0]]}else t=n;if(t.length<=0&&(t=n),(c=o.length===u.length)||(t=[t[t.length-1]]),2===t.length){var x=null,N=t[t.length-1],j=s(N),q=s(t[0]),O=-1*I(j,q);if(O>0){var p=q.getFullYear(),w=q.getMonth(),R=q.getDate();o=[],u=[];for(var y=0;y<O;y++){var M=new Date(p,w,R+y),A=r(M).value;l(A)&&(x=M,u.push(A)),~o.indexOf(A)||o.push(A)}var E=I(x,j);1===E||-1===E?c=!0:(o=[],t=[t[0]],c=!1)}if(u.length===o.length?c=!0:(c=!1,t=[t[0]]),o.length>i){c=!1;var L=t[t.length-1];t=l(L)?[L]:[n[0]]}}}else{t.length>=2&&h===f&&t.pop();var P=I(g,v);if(P>0&&P<=i){for(var y=1;y<P;y++){var $=new Date(g.getFullYear(),g.getMonth(),g.getDate()+y);o.push(r($).value)}c=!0}else(P>i||P<0)&&t.shift()}return{selected:t,allValid:c,range:o}}({date:m,selected:a,cache:e,limit:o,format:d,parse:l,inDates:u,infiniteMode:h,bindData:D});a=b.selected;var y=b.range,M=b.allValid,Y=a[0],S=a[a.length-1],V=I(l(Y),l(S)),F=function(e,t,a,i,r,s){var l={start:e.querySelector(".start-date"),end:e.querySelector(".end-date")},d={start:e.querySelector(n("data-date",t)),end:e.querySelector(n("data-date",a))};{if(0===i)return!f(d.start,"disabled")&&(v(l.start,"start-date"),v(l.start,"active"),v(l.end,"end-date"),v(l.end,"active"),g(d.start,"active"),g(d.start,"start-date"),!0);g(d.end,"active"),i>0?r?(g(d.end,"start-date"),v(l.start,"start-date"),v(l.start,"active")):s?g(d.end,"end-date"):(v(d.start,"active"),v(d.start,"start-date"),g(d.end,"start-date")):i<0&&(v(d.start,"active"),v(d.start,"start-date"),g(d.end,"start-date"))}return!0}(t,Y,S,V,V>o,M);F&&k([],t,!0),M&&F&&k(y,t,!1)}else{var x=p,N=!0;u(m)||(a=e,N=!1),function(e,t,a){if(a){for(var n=t.querySelectorAll(".active"),i=0;i<n.length;i++)v(n[i],"active");f(e,"disabled")||g(e,"active")}}(x,t,N)}var j="selected";if(s&&D)if(a.length<=1){var q=a[0];u(q)||(j="disabled")}else if(a.length>=2){var O=i(p.previousElementSibling,"data-date"),R=-1*r(l(a[0]),l(m),"days");(!u(m)&&!u(O)||R>o||R<0)&&(j="disabled")}c({type:j,value:a})})},w=0;w<m.length;w++)p(w)};function I(e,t){var a=r(e,t,"days");return 0===a?0:-1*a}function L(e,t){t||(t="YYYY-MM-DD");var a=function(e){if(!e)return new Date;if(e instanceof Date)return e;var t=new Date(e);return t.getTime()?new Date(t.getFullYear(),t.getMonth(),t.getDate()):null}(e);if(a)return a;var n=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,i={D:[/\d{1,2}/,function(e,t){return e.day=parseInt(t)}],M:[/\d{1,2}/,function(e,t){return e.month=parseInt(t)-1}],DD:[/\d{2}/,function(e,t){return e.day=parseInt(t)}],MM:[/\d{2}/,function(e,t){return e.month=parseInt(t)-1}],YY:[/\d{2,4}/,function(e,t){return e.year=parseInt(t)}],YYYY:[/\d{2,4}/,function(e,t){return e.year=parseInt(t)}]};return(a=function(e,t){if(e.length>1e3)return null;var a=!0,r={year:0,month:0,day:0};if(t.replace(n,function(t){if(i[t]){var n=i[t],s=n[0],l=n[n.length-1],d=e.search(s);~d?e.replace(n[0],function(t){return l(r,t),e=e.substr(d+t.length),t}):a=!1}return i[t]?"":t.slice(1,t.length-1)}),!a)return null;var s=new Date(r.year,r.month,r.day);return new Date(s.getFullYear(),s.getMonth(),s.getDate())})(e,t)}function P(e,t){var a,n=this;if(e.bindData){var i={dates:[],data:{}},r=t&&t(i),s=r||i,l={data:s.data,dates:s.dates.sort(function(e,t){return n.parse(e)-n.parse(t)})};this.init(e,l),!c(a=s)||Object.keys(a.data).length<=0||a.dates.length<=0||this.dataRenderer(s.data)}}return function(){function e(e){var n=this;this.init=A,this.date=new Date,this.limit=1,this.double=!1,this.element=null,this.startDate=new Date,this.endDate=null,this.selected=[],this.flatView=!1,this.multiViews=!1,this.singleView=!0,this.doMonthSwitch=j,this.createDatePicker=q,this.bindData=!1,this.infiniteMode=!1,this.currentRange=O,this.isFromSetRange=!1,this.language={},this.disableds=[],this.pickDate=function(){E({element:n.element,selected:n.selected,isDouble:n.double,source:n.dates,parse:n.parse,format:n.format,limit:n.limit,inDates:n.inDates,update:n.update,infiniteMode:n.infiniteMode,bindData:n.bindData})},this.format=function(e,t){return function(e,t){t||(t="YYYY-MM-DD"),t=t.toUpperCase();var a={YYYY:e.getFullYear(),DD:d(e.getDate()),MM:d(e.getMonth()+1),D:e.getDate(),M:e.getMonth()+1},n=function(e){var t=e.split(/\W/,3);t.shift();for(var a=[],n=0;n<t.length;n++){var i=t[n];/\w\w/.test(i)&&a.push(i)}return t.length===a.length}(t);return{origin:e,date:n?a.DD:a.D,month:n?a.MM:a.M,year:a.YYYY,day:e.getDay(),value:t.replace(/(?:\b|%)([dDMyY]+)(?:\b|%)/g,function(e,t){return void 0===a[t]?t:a[t]})}}(e,t||n.dateFormat)},this.parse=function(e,t){return L(e,t||n.dateFormat)},this.inDates=function(e){return n.dates.indexOf(e)>=0},this.update=function(e){var a=e.type,i=e.value;"selected"===a?n.setDates(i,!1):"switch"===a&&n.defaultDates.length>0&&(n.selected=n.defaultDates),"disabled"!==a&&"switch"!==a&&t.$emit("update",e)},this.dataRenderer=function(e){if(Object.keys(e).length<=0)t.$remove("data");else var a=D(function(){t.$emit("data",{data:e,nodeList:n.element.querySelectorAll(".calendar-cell")}),m(a)})},this.setDates=function(e,t){if(u(e)){n.isFromSetRange=!!t;var a=function(t,a,i){if(i<0||i>n.limit||!n.inDates(n.format(t).value)&&!n.inDates(n.format(a).value)||!n.inDates(n.format(t).value))return p("setDates","Illegal dates,["+e+"]"),!1;for(var r=0;r<=i;r++){var s=new Date(t.getFullYear(),t.getMonth(),t.getDate()+r),l=n.format(s).value;if(r<i&&!n.inDates(l))return p("setDates","Illegal date,{dates:["+l+"]}"),!1}return!0},i=function(t){var a=[],i="",s="";if(n.double){e.length>2&&(e=e.slice(0,2)),i=e[0],s=e[e.length-1];var l=h(i)?i:n.parse(i),d=h(s)?s:n.parse(s),o=-1*r(l,d,"days");if(t&&"function"==typeof t)if(!(t&&t(l,d,o)))return!1;a=[n.format(l).value,n.format(d).value]}else{var u=e[e.length-1];a=[h(u)?n.format(u).value:u]}n.defaultDates=a};if(n.bindData)var s=D(function(){i(a),m(s)});else i()}else p("setDates","no dates provided,"+(e=[]))},this.bindMonthSwitch=R,this.initWithDataBind=P;var i={diff:function(e,t){return r(e,t,"days")},parse:function(e,t){return n.parse(e,t)},format:function(e,t){return n.format(e,t).value}},s={};return e&&(this.defaultDates=[],this.bindData=e.bindData,!e.bindData&&e.el&&this.init(e,{}),s={on:t.$on,data:function(t){return n.initWithDataBind(e,t)},dateRanges:function(e,t){console.warn("dateRanges has been deprecated, use [setDates] instead"),n.setDates(e,t)},disable:this.disable,setDefaultDates:function(){p("setDefaultDates","this method has been deprecated,use [setDates()] instead ")},setDates:this.setDates}),a(i,s)}return e.prototype.disable=function(){},e}()});