!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.DatePicker=t()}(this,function(){"use strict";function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e,t){return t={exports:{}},e(t,t.exports),t.exports}var a=t(function(e,t){t.__esModule=!0;var a=function(){var e={};return{$on:function(t,a){e[t]||(e[t]=[]),e[t].push(a)},$emit:function(t,a){var n=arguments,r=this,i=[].shift.call(arguments),s=e[i];if(!s||0===s.length)return!1;for(var l=0,d=void 0;d=s[l++];)d.apply(r,n)},$remove:function(t,a){var n=e[t];if(!n)return!1;if(a)for(var r=n.length-1;r>=0;r--)n[r]===a&&n.splice(r,1);else n&&(n.length=0)}}}();t.default=a});e(a);var n=t(function(e,t){function a(e){return"[object Array]"===r(e)}function n(e,t){if(1===e.length)return e;if(0===e.length)return[];for(var a=[],r=[],i=[],s=e[0],l=0;l<e.length;l++)e[l]<s?a.push(e[l]):e[l]>s?r.push(e[l]):i.push(e[l]);return t?[].concat(n(a,t),i,n(r,t)):[].concat(n(r,t),i,n(a,t))}t.__esModule=!0,t.diff=function(e,t,a){if(void 0===a&&(a="month"),"month"==a)return Math.abs(12*e.getFullYear()+e.getMonth()-(12*t.getFullYear()+t.getMonth()));if("days"===a){var n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),r=new Date(t.getFullYear(),t.getMonth(),t.getDate());return Math.round(n-r)/864e5}},t.attrSelector=function(e,t){return"["+e+'="'+t+'"]'},t.getDates=function(e,t){var a=new Date(e,t,1),n=Date.UTC(a.getFullYear(),a.getMonth()+1,0);return new Date(n).getUTCDate()},t.padding=function(e){return""+(e>9?e:"0"+e)},t.getFirstDay=function(e,t){return new Date(e,t,1).getDay()},t.getWeeksOfMonth=function(e){var t=new Date(e.getFullYear(),e.getMonth()-1,1),a=new Date(e.getFullYear(),e.getMonth(),0),n=t.getDay()+a.getDate();return Math.ceil(n/7)},t.getLastDay=function(e,t){return new Date(e,t+1,0).getDay()},t.getLastDates=function(e){for(var a=t.getLastDay(e.getFullYear(),e.getMonth()),n=e.getDate()-a,r=[],i=0;i<=a;i++)n+i<=e.getDate()&&r.push(n+i);return r},t.inArray=function(e,t){return!(!a(e)||e.length<=0||!t)&&~e.indexOf(t)},t.attr=function(e,t,a){if(void 0===a&&(a=void 0),!e)return null;var n=e.getAttribute(t);return void 0===a&&(a=""),n||e.setAttribute(t,a)},t.remove=function(e,t){if(e.length){var a=e.indexOf(t);if(a>-1)return e.splice(a,1)}};var r=function(e){return Object.prototype.toString.call(e)};t.isBoolean=function(e){return"[object Boolean]"===r(e)},t.isArray=a,t.isObject=function(e){return"[object Object]"===r(e)},t.isNumber=function(e){return"[object Number]"===r(e)},t.isString=function(e){return"[object String]"===r(e)},t.isDate=function(e){return"[object Date]"===r(e)},t.isNil=function(e){return null===e||void 0===e||void 0===e},t.isPrimitive=function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e},t.hasClass=function(e,t){return!!e&&e.classList.contains(t)},t.removeClass=function(e,t){if(e)return e.classList.remove(t)},t.addClass=function(e,t){if(e&&!e.classList.contains(t))return e.classList.add(t)},t.parseEl=function(e){return e?e.indexOf("#")>=0?document.querySelector(e):e.indexOf(".")>=0?document.querySelectorAll(e)[0]:~["a","p","div","section","span","article","header","footer","main","aside","i","strong","small","tr","table"].indexOf(e)?(console.error("[DatePicker Warn] do not mount datepicker to pure html tag, use class name or id instead "),null):document.querySelector(e):null},t.defaultLanguage={locale:"zh-cn",pack:{days:["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],months:["01\u6708","02\u6708","03\u6708","04\u6708","05\u6708","06\u6708","07\u6708","08\u6708","09\u6708","10\u6708","11\u6708","12\u6708"],year:"\u5e74"}},t.setLanguage=function(e){var t,a=e.locale.toLowerCase(),n=e.pack,r=n.months,i=n.days;return t="en"===a||"en-us"===a||"en-gb"===a?function(e,t){return r[t]+" "+e}:function(e,t){return""+e+n.year+r[t]},{week:i,title:t}},t.getLanguage=function(e,a){return a&&e[a]?{locale:a,pack:e[a]}:t.defaultLanguage},t.quickSort=n});e(n);var r=t(function(e,t){function a(e){return parseInt(e,10)}function r(e){if(!e)return new Date;if(e instanceof Date)return e;var t=new Date(e);return t.getTime()||(t=null),t}t.__esModule=!0,t.format=function(e,t,a){var r={DD:n.padding(e.getDate()),MM:n.padding(e.getMonth()+1),YYYY:e.getFullYear()};return{origin:e,date:r.DD,month:r.MM,year:r.YYYy,day:e.getDay(),value:t.replace(/(?:\b|%)([dDMyYHhaAmsz]+|ap|AP)(?:\b|%)/g,function(e,t){return void 0===r[t]?t:r[t]})}},t.parseFormatted=function(e,t){var n,i,s,l={DD:"([0-9][0-9])",dd:"([0-9][0-9])",MM:"([0-9][0-9])",mm:"([0-9][0-9])",YYYY:"([0-9][0-9][0-9][0-9])",yyyy:"([0-9][0-9][0-9][0-9])","%":""},d="",o=0,u=[""],c="",f=r(e);if(f)return f;for(f=new Date(2e3,0,1);o<t.length;){for(n=t.charAt(o);o+1<t.length&&void 0!==l[n+t.charAt(o+1)];)n+=t.charAt(++o);void 0!==(c=l[n])?""!==c&&(d+=l[n],u.push(n)):d+=n,o++}if(i=e.match(new RegExp(d)),s=u.length,!i||i.length!==s)return null;for(o=0;o<s;o++)if(""!==(n=u[o]))switch(c=a(i[o]),n){case"YYYY":f.setYear(c);break;case"MM":f.setMonth(c);break;case"DD":f.setDate(c)}return f}});e(r);var i=t(function(e,t){t.__esModule=!0;var a=function(){function e(e){this.stack=[],this.isEmpty()&&this.push(e)}return e.prototype.pop=function(){return this.stack.pop()},e.prototype.push=function(e){var t=this;if(n.isArray(e))for(var a=0;a<e.length;a++)t.stack.push(e[a]);else this.stack.push(e)},e.prototype.clear=function(){this.stack=[]},e.prototype.size=function(){return this.stack.length},e.prototype.peek=function(){return this.stack[this.stack.length-1]},e.prototype.isEmpty=function(){return 0===this.stack.length},e.prototype.shift=function(e){return this.stack.shift()},e.prototype.unshift=function(e){this.stack.unshift(e)},e.prototype.toString=function(e){return e?this.stack.join(e):this.stack.join(" ")},e}();t.default=a});e(i);var s=t(function(e,t){function a(e){var t=new i.default(["calendar-cell","calendar-date-cell"]);return e?(n.diff(e,u,"days")<0&&t.push("disabled"),0===e.getDay()&&t.push("calendar-cell-weekend"),6===e.getDay()&&t.push("calendar-cell-weekday")):t.push(["disabled","empty"]),t.toString()}function s(e,t,i){for(var s=[],l=new Date(e,t,1),d={year:l.getFullYear(),month:l.getMonth(),date:l.getDate(),index:l.getMonth()},o=n.getFirstDay(d.year,d.month),u=0;u<o;u++)s.push({date:"",className:a(),text:"<div class='date'></div><div class='placeholder'></div>",key:""});for(var c=1;c<=n.getDates(d.year,d.month);c++){var f=new Date(d.year,d.month,c),h=r.format(f,i).value,v='<div class="date">'+n.padding(c)+'</div><div class="placeholder"></div>';s.push({date:c,className:a(f),text:v,key:h})}return{template:s.map(function(e){return'<div class="'+e.className+'"\n            '+(e.key?"data-date="+e.key:"")+">"+e.text+"</div>"}).join(" "),year:d.year,month:d.index}}function l(e,t,a){for(var n=[],r=0;r<=a;r++){var i=new Date(e.getFullYear(),e.getMonth()+r,1),l=s(i.getFullYear(),i.getMonth(),t);n.push({template:l.template,year:l.year,month:l.month})}return n}function d(e,t){return t?"":" calendar-"+e}function o(e,t,a,n){var r=n.week.map(function(e,t){return'<div class="'+new i.default(["calendar-cell","calendar-day-cell",0===t?"calendar-cell-weekday":6===t?"calendar-cell-weekend":""]).toString()+'">'+e+"</div>"}).join(""),s=e.map(function(e,i){var s=e.year,l=e.month,o='<div class="calendar-title">'+n.title(s,l)+"</div>",u=e.template,c="";return t||a?c='<div class="calendar-main'+d(i,a)+'">\n                   <div class="calendar-head">'+o+'</div>  \n                   <div class="calendar-day"> '+r+'</div>\n                    <div class="calendar-body">'+u+"</div>\n            </div>":c+="<div class='calendar-main calendar-"+i+'\'>\n                    <div class="calendar-head">'+o+'</div>\n                    <div class="calendar-body">'+u+"</div>\n              </div>",c});return t||a||s.unshift('<div class="calendar-day">'+r+"</div>"),s.join("")}t.__esModule=!0;var u=new Date;t.default=function(e,t,a,r,i,s){var d="calendar-"+(r?"double-views":i?"single-view":"flat-view"),u=o(l(e,a,r?1:i?0:n.diff(e,t)),r,i,s);return'<div class="calendar '+d+'"> '+(r||i?"\n         <div class=\"calendar-action-bar\">\n            <button class='calendar-action calendar-action-prev'><span>prev</span></button>\n            <button class='calendar-action calendar-action-next'><span>next</span></button>\n         </div>\n        ":"")+u+"</div>"}});e(s);var l=t(function(e,t){function a(e,t,a){for(var r=[],i=0;i<e.length;i++){var s=n.attr(e[i],"data-date");s&&r.push(s)}for(var l=-1,d=-1,i=0;i<r.length;i++){var o=r[i];o===t?l=i:o===a&&(d=i)}return d===l||d<0?[]:r.slice(l+1,d)}function r(e,t,a,r){for(var i=function(e){return n.inArray(t,e)},s=[],d=a[0],o=a[a.length-1],u=0;u<e.length;u++){var c=e[u],f=e[u+1];if(a.length>0){var h=n.attr(e[u],"data-date");h===d?n.addClass(c,"start-date"):h===o&&n.addClass(c,"end-date")}else if(c&&f){var v=n.attr(c,"data-date"),g=n.attr(f,"data-date");if(v&&g){var m=r(v);n.diff(m,l,"days")>=0&&(i(g)&&i(v)||i(v)&&!i(g))&&s.length<2&&(n.addClass(c,"start-date"),n.addClass(f,"end-date"),s.push(v,g))}}}return a.length>0&&(s=a),s}function i(e,t,a,r){if(a)for(var i=t.querySelectorAll(".in-range"),s=0;s<i.length;s++)n.removeClass(i[s],"in-range");else for(s=0;s<e.length;s++){var l=n.attrSelector("data-date",e[s]),d=t.querySelector(l);n.hasClass(d,"active")||n.addClass(d,"in-range")}if(r)return[]}t.__esModule=!0;var s=new Date,l=new Date(s.getFullYear(),s.getMonth(),s.getDate());t.ranged=i,t.setDefaultRange=function(e,t,s,l,d,o,u){function c(e){return~l.indexOf(e)}var f=[];if(d){if(s.length>=2){var h=s[0],v=s[s.length-1];c(h)||(s=[]);for(var g=o(h),m=o(v),p=g.getFullYear(),D=g.getMonth(),y=g.getDate(),w=[],b=n.diff(m,g,"days")+1,C=0;C<b;C++){var M=u(new Date(p,D,y+C)).value;c(M)||w.push(M)}w.length>=2&&(s=[])}else 1===s.length&&(s=[]);var k=a(t,(f=r(t,l,s,o))[0],f[f.length-1]);k.length>0&&i(k,e,!1)}else f=s;for(C=0;C<f.length;C++){var Y=n.attrSelector("data-date",f[C]),S=e.querySelector(Y);n.addClass(S,"active")}return f}});e(l);var d=t(function(e,t){t.__esModule=!0,t.monthSwitch=function(e,t,a){var n={year:this.date.getFullYear(),month:this.date.getMonth(),date:this.date.getDate()},r=n.month+e;this.multiViews&&(r+=e>0?1:-1),this.date=new Date(n.year,r,n.date),this.buildCalendar(t,a),this.handlePickDate(this.element,this.selected,this.double,this.dates,this.parse,this.format,this.limit,this.update),this.dataRenderer(this.data)},t.buildCalendar=function(e,t){var a=this;if(this.element=n.parseEl(e),!this.element)return console.error("[Calendar Warn] invalid selector,current selector "+e),!1;var r=this.startDate.getTime(),i=(this.endDate.getTime(),this.date.getTime());this.element.innerHTML=s.default(this.date,this.endDate,this.dateFormat,this.multiViews,this.flatView,n.setLanguage(t)),this.defaultDates.length>0?this.defaultDates:this.format(this.date).value;var d=this.defaultDates.length>0?this.defaultDates:this.double?this.selected:[this.format(this.date).value];console.log(this.selected),setTimeout(function(){a.selected=l.setDefaultRange(a.element,a.element.querySelectorAll(".calendar-date-cell:not(.empty)"),d,a.dates,a.double,a.parse,a.format)},10);var o=this.element.querySelector(".calendar-action-prev"),u=this.element.querySelector(".calendar-action-next");o&&u&&(n.diff(this.date,this.endDate)>=2?u.addEventListener("click",function(){a.monthSwitch(1,e,t),n.removeClass(o,"disabled"),n.removeClass(o,"calendar-action-disabled")}):(n.addClass(u,"disabled"),n.addClass(u,"calendar-action-disabled")),i>r?o.addEventListener("click",function(){a.monthSwitch(-1,e,t),n.removeClass(u,"disabled"),n.removeClass(u,"calendar-action-disabled")}):(n.addClass(o,"disabled"),n.addClass(o,"calendar-action-disabled")))},t.init=function(e,t){var a=this;if(e.format&&(this.dateFormat=e.format),!e.multiViews&&e.flatView&&(this.multiViews=!1,this.flatView=!0),(e.flatView&&e.multiViews||!e.flatView&&e.multiViews)&&(this.flatView=!1,this.multiViews=!0),e.flatView||e.multiViews||(this.flatView=!1,this.multiViews=!1),this.double=!!n.isBoolean(e.doubleSelect)&&e.doubleSelect,this.startDate=n.isDate(e.from)?e.from:new Date,this.date=this.startDate,this.endDate=n.isDate(e.to)?e.to:new Date(this.date.getFullYear(),this.date.getMonth()+6,this.date.getDate()),this.limit=this.double&&n.isNumber(e.limit)?e.limit:1,this.flatView){var r=this.endDate.getFullYear(),i=this.endDate.getMonth(),s=this.endDate.getDate();this.endDate=new Date(r,i+1,s)}if(!t.dates||t.dates&&t.dates.length<=0){for(var l=new Date,d=n.diff(this.endDate,l,"days"),r=l.getFullYear(),i=l.getMonth(),s=l.getDate(),o=[],u=0;u<d;u++){var c=new Date(r,i,s+u),f=a.format(c).value;o.push(f)}this.data={},this.dates=o}else this.dates=t.dates,this.data=t.data;this.buildCalendar(e.el,n.getLanguage(e.language,e.defaultLanguage)),this.handlePickDate(this.element,this.selected,this.double,this.dates,this.parse,this.format,this.limit,this.update)}});e(d);var o=t(function(e,t){function a(e,t,a){if(a){for(var r=t.querySelectorAll(".active"),i=0;i<r.length;i++)n.removeClass(r[i],"active");n.hasClass(e,"disabled")||n.addClass(e,"active")}}function r(e,t,a,r,i,s){var l={start:e.querySelector(".start-date"),end:e.querySelector(".end-date")},d={start:e.querySelector(n.attrSelector("data-date",t)),end:e.querySelector(n.attrSelector("data-date",a))};0===r?(n.removeClass(l.start,"start-date"),n.removeClass(l.start,"active"),n.removeClass(l.end,"end-date"),n.removeClass(l.end,"active"),n.addClass(d.start,"active"),n.addClass(d.start,"start-date")):(n.addClass(d.end,"active"),r>0?i?(n.addClass(d.end,"start-date"),n.removeClass(l.start,"start-date"),n.removeClass(l.start,"active")):s?n.addClass(d.end,"end-date"):(n.removeClass(d.start,"active"),n.removeClass(d.start,"start-date"),n.addClass(d.end,"start-date")):r<0&&(n.removeClass(d.start,"active"),n.removeClass(d.start,"start-date"),n.addClass(d.end,"start-date")))}function i(e,t){var a=n.diff(e,t,"days");return 0===a?0:-1*a}function s(e,t,a,r,s,l,d){function o(e){return n.inArray(s,e)}var u=[],c=[],f=t[0],h=t[t.length-1],v=d(f),g=i(v,d(h)),m=t.length;if(m>=2)if(g<=0)o(e)?t.shift():t=[t[0]];else if(o(h))for(var p=v.getFullYear(),D=v.getMonth(),y=v.getDate(),w=1;w<g;w++){var b=l(V=new Date(p,D,y+w)).value;o(b)&&c.push(b),u.push(b)}else o()&&h&&(t.shift(),u.push(h));else if(1===m){var C=t[t.length-1];t=o(C)?[C]:a}else t=a;var M=u.length===c.length;if(M||(t=[t[t.length-1]]),2===t.length){var k=null,Y=d(t[t.length-1]),S=d(t[0]),F=-1*i(Y,S);if(F>0){var p=S.getFullYear(),D=S.getMonth(),x=S.getDate();u=[],c=[];for(w=0;w<F;w++){var V=new Date(p,D,x+w),A=l(V).value;o(A)&&(k=V,c.push(A)),~u.indexOf(A)||u.push(A)}var L=i(k,Y);1===L||-1===L?M=!0:(u=[],t=[t[0]],M=!1)}if(c.length===u.length?M=!0:(M=!1,t=[t[0]]),u.length>r){M=!1;var _=t[t.length-1];t=o(_)?[_]:[a[0]]}}return{selected:t,allValid:M,range:u}}t.__esModule=!0,t.default=function(e,t,d,o,u,c,f,h){function v(e){return n.inArray(o,e)}for(var g=e.querySelectorAll(".calendar-date-cell"),m=0;m<g.length;m++)!function(m){var p=g[m];p.addEventListener("click",function(g){var m=t,D=n.attr(p,"data-date"),y=t.indexOf(D);if(!D||y>=0)return!1;if((d&&t.length>=2||!d)&&(t=[]),t.push(D),d){var w=s(D,t,m,f,o,c,u);t=w.selected;var b=w.range,C=w.allValid,M=t[0],k=t[t.length-1],Y=i(u(M),u(k));r(e,M,k,Y,Y>f,C),l.ranged([],e,!0),C&&l.ranged(b,e,!1)}else{var S=p,F=!0;v(D)||(t=m,F=!1),a(S,e,F)}h(t)})}(m)}});return e(o),e(t(function(e,t){t.__esModule=!0;var i=function(){function e(e){function t(e){return!n.isObject(e)||Object.keys(e.data).length<=0||e.dates.length<=0}var i=this;return this.init=d.init,this.date=new Date,this.limit=1,this.double=!1,this.dateFormat="YYYY-MM-DD",this.element=null,this.startDate=new Date,this.endDate=null,this.selected=[],this.flatView=!1,this.multiViews=!1,this.monthSwitch=d.monthSwitch,this.buildCalendar=d.buildCalendar,this.handlePickDate=o.default,this.format=function(e){return r.format(e,i.dateFormat)},this.parse=function(e){return r.parseFormatted(e,i.dateFormat)},this.update=function(e){a.default.$emit("update",e),i.selected=e},this.dataRenderer=function(e){Object.keys(e).length<=0?a.default.$remove("data"):a.default.$emit("data",{data:e,nodeList:i.element.querySelectorAll(".calendar-date-cell")})},this.defaultDates=[],e.bindData||this.init(e,{}),{on:a.default.$on,data:function(a){if(e.bindData){var r=a&&a({dates:[],data:{}});if(t(r))i.init(e,{});else{for(var s=r.dates,l=[],d=[],o=0;o<s.length;o++)d.push(i.parse(s[o]).getTime());d=n.quickSort(d).reverse();for(o=0;o<d.length;o++)l.push(i.format(new Date(d[o])).value);i.init(e,{data:r.data,dates:l}),i.dataRenderer(r.data)}i.update(i.selected)}},diff:function(e,t){return n.diff(e,t,"days")},parse:this.parse,format:this.format,setDefaultDates:function(t){if(!t)return console.error("[setDefaultDates error] no dates provided",t),void(i.defaultDates=[]);if(t&&t instanceof Array){if(t.length<=0)return void console.error("[setDefaultDates error] no dates provided",t);if(e.doubleSelect){1===t.length?console.error("[setDefaultDates] please provide end date"):t.length>2&&(t=t.slice(0,2));var a=t[0],r=t[t.length-1],s=i.parse(a),l=i.parse(r);if(!s||!l)return console.error("[setDefaultDates error] illegal dates,",t),void(i.defaultDates=[]);var d=n.diff(s,l,"days"),o=n.diff(l,s,"days");if(e.limit||(e.limit=1),d>0||o>e.limit||o<-1*e.limit)return console.error("[setDefaultDates error] illegal start date or end date or out of limit,your selected dates:["+t+"],limit:["+e.limit+"]"),i.defaultDates=[],!1}else t=[t[0]];i.defaultDates=t,i.update(t)}}}}return e.prototype.inDates=function(e){return console.error(this.dates),~this.dates.indexOf(e)},e}();t.default=i}))});